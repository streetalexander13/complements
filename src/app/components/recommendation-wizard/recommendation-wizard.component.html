<div class="wizard-container">
  <!-- Journey Progress -->
  <div class="journey-progress" *ngIf="currentStep <= totalSteps">
    <div class="container-narrow">
      <div class="progress-content">
        <div class="progress-text">
          <span class="step-indicator">{{ currentStep }} of {{ totalSteps }}</span>
          <span class="step-title">{{ getStepTitle() }}</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="getProgressPercentage()"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Journey Content -->
  <div class="journey-content" *ngIf="currentStep <= totalSteps">
    <div class="container-narrow">
      <div class="step-container">
        
        <!-- Step 1: Welcome & Basic Info -->
        <div *ngIf="currentStep === 1" class="step-content">
          <div class="step-header">
            <div class="step-badge">
              <span class="badge-text">Personalized Assessment</span>
            </div>
            <h1 class="step-title">Let's build your perfect performance box</h1>
            <p class="step-description">Get supplements, equipment, and guides that actually work for your sport. <strong>No more guessing.</strong></p>
          </div>
          
          <form [formGroup]="wizardForm" class="journey-form">
            <div class="form-group">
              <label class="form-label">What's your name?</label>
              <input 
                type="text" 
                formControlName="name" 
                class="form-input"
                placeholder="Enter your name"
                minlength="2">
            </div>

            <div class="form-group">
              <label class="form-label">How old are you?</label>
              <input 
                type="number" 
                formControlName="age" 
                class="form-input"
                placeholder="Enter your age"
                min="13" 
                max="120">
            </div>

            <div class="form-group">
              <label class="form-label">Gender</label>
              <div class="radio-group">
                <label class="radio-option">
                  <input type="radio" formControlName="gender" value="male">
                  <span class="radio-label">Male</span>
                </label>
                <label class="radio-option">
                  <input type="radio" formControlName="gender" value="female">
                  <span class="radio-label">Female</span>
                </label>
                <label class="radio-option">
                  <input type="radio" formControlName="gender" value="other">
                  <span class="radio-label">Other</span>
                </label>
              </div>
            </div>
          </form>
        </div>

        <!-- Step 2: Sport & Activity -->
        <div *ngIf="currentStep === 2" class="step-content">
          <div class="step-header">
            <div class="step-badge">
              <span class="badge-text">Sport Customization</span>
            </div>
            <h1 class="step-title">What sports do you do?</h1>
            <p class="step-description">Select all that apply. We'll customize your box with sport-specific equipment and supplements.</p>
          </div>
          
          <form [formGroup]="wizardForm" class="journey-form">
            <div class="form-group">
              <label class="form-label">Sports and activities</label>
              <div class="sport-grid">
                <label *ngFor="let sport of sports" class="sport-option">
                  <input 
                    type="checkbox" 
                    [checked]="isSportSelected(sport.value)"
                    (change)="onSportChange(sport.value, $event)">
                  <div class="sport-card">
                    <div class="sport-icon">{{ sport.icon }}</div>
                    <span class="sport-label">{{ sport.label }}</span>
                  </div>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">How many times do you train per week?</label>
              <div class="radio-group">
                <label *ngFor="let frequency of trainingFrequencies" class="radio-option">
                  <input type="radio" formControlName="trainingFrequency" [value]="frequency">
                  <span class="radio-label">{{ frequency }}</span>
                </label>
              </div>
            </div>
          </form>
        </div>

        <!-- Step 3: Goals & Level -->
        <div *ngIf="currentStep === 3" class="step-content">
          <div class="step-header">
            <div class="step-badge">
              <span class="badge-text">Level Selection</span>
            </div>
            <h1 class="step-title">What's your fitness level?</h1>
            <p class="step-description">Choose the box that matches where you are now. <em>You can always upgrade later.</em></p>
          </div>
          
          <form [formGroup]="wizardForm" class="journey-form">
            <div class="form-group">
              <label class="form-label">Fitness level</label>
              <div class="level-grid">
                <label class="level-option">
                  <input type="radio" formControlName="fitnessLevel" value="beginner">
                  <div class="level-card">
                    <h3>Beginner</h3>
                    <p>New to supplements and performance nutrition</p>
                    <div class="level-price">¬£29/month</div>
                  </div>
                </label>
                <label class="level-option">
                  <input type="radio" formControlName="fitnessLevel" value="intermediate">
                  <div class="level-card featured">
                    <div class="level-badge">Most Popular</div>
                    <h3>Intermediate</h3>
                    <p>Want to build a solid foundation</p>
                    <div class="level-price">¬£39/month</div>
                  </div>
                </label>
                <label class="level-option">
                  <input type="radio" formControlName="fitnessLevel" value="advanced">
                  <div class="level-card">
                    <h3>Advanced</h3>
                    <p>Looking to optimize performance</p>
                    <div class="level-price">¬£49/month</div>
                  </div>
                </label>
                <label class="level-option">
                  <input type="radio" formControlName="fitnessLevel" value="elite">
                  <div class="level-card">
                    <h3>Elite</h3>
                    <p>Maximum performance optimization</p>
                    <div class="level-price">¬£69/month</div>
                  </div>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">What are your main goals?</label>
              <div class="checkbox-group">
                <label *ngFor="let goal of healthGoals" class="checkbox-option">
                  <input 
                    type="checkbox" 
                    [checked]="isGoalSelected(goal)"
                    (change)="onGoalChange(goal, $event)">
                  <span class="checkbox-label">{{ formatGoalLabel(goal) }}</span>
                </label>
              </div>
            </div>
          </form>
        </div>

        <!-- Step 4: Diet & Preferences -->
        <div *ngIf="currentStep === 4" class="step-content">
          <div class="step-header">
            <h1 class="step-title">Your dietary preferences</h1>
            <p class="step-description">This ensures we send you compatible supplements and snacks</p>
          </div>
          
          <form [formGroup]="wizardForm" class="journey-form">
            <div class="form-group">
              <label class="form-label">Diet type</label>
              <div class="radio-group">
                <label *ngFor="let diet of dietTypes" class="radio-option">
                  <input type="radio" formControlName="dietType" [value]="diet">
                  <span class="radio-label">{{ formatDietLabel(diet) }}</span>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Any allergies or restrictions?</label>
              <textarea 
                formControlName="allergies" 
                class="form-textarea"
                placeholder="List any allergies or dietary restrictions"
                rows="3"></textarea>
            </div>

            <div class="form-group">
              <label class="form-label">Current supplements (optional)</label>
              <textarea 
                formControlName="currentSupplements" 
                class="form-textarea"
                placeholder="List current supplements you're taking"
                rows="3"></textarea>
            </div>
          </form>
        </div>

        <!-- Step 5: Health & Medical -->
        <div *ngIf="currentStep === 5" class="step-content">
          <div class="step-header">
            <h1 class="step-title">Any health considerations?</h1>
            <p class="step-description">This helps us ensure safe recommendations and avoid contraindications</p>
          </div>
          
          <form [formGroup]="wizardForm" class="journey-form">
            <div class="form-group">
              <label class="form-label">Medical conditions (optional)</label>
              <textarea 
                formControlName="medicalConditions" 
                class="form-textarea"
                placeholder="List any medical conditions"
                rows="3"></textarea>
            </div>

            <div class="form-group">
              <label class="form-label">Current medications (optional)</label>
              <textarea 
                formControlName="medications" 
                class="form-textarea"
                placeholder="List current medications"
                rows="3"></textarea>
            </div>
          </form>
        </div>

        <!-- Step 6: Review & Subscribe -->
        <div *ngIf="currentStep === 6" class="step-content">
          <div class="step-header">
            <h1 class="step-title">Your personalized box</h1>
            <p class="step-description">Review your selections and start your subscription</p>
          </div>
          
          <div class="box-preview">
            <div class="box-header">
              <h3>{{ getUserName() }}'s Box</h3>
              <div class="box-level">{{ getSelectedLevel() }}</div>
            </div>
            
            <div class="box-contents">
              <div class="content-section">
                <h4>Equipment</h4>
                <div class="benefit-list">
                  <div class="benefit-item">
                    <span class="benefit-icon">YOGA</span>
                    <div class="benefit-content">
                      <h5>Foam Roller</h5>
                      <p>Recovery after training sessions</p>
                    </div>
                  </div>
                  <div class="benefit-item">
                    <span class="benefit-icon">CLIMB</span>
                    <div class="benefit-content">
                      <h5>Yoga Mat</h5>
                      <p>Flexibility and mobility work</p>
                    </div>
                  </div>
                  <div class="benefit-item" *ngIf="isSportSelected('climbing')">
                    <span class="benefit-icon">CLIMB</span>
                    <div class="benefit-content">
                      <h5>Climbing Chalk</h5>
                      <p>Improves grip, reduces skin tears</p>
                    </div>
                  </div>
                  <div class="benefit-item" *ngIf="isSportSelected('running')">
                    <span class="benefit-icon">RUN</span>
                    <div class="benefit-content">
                      <h5>Resistance Bands</h5>
                      <p>Strength training for runners</p>
                    </div>
                  </div>
                  <div class="benefit-item" *ngIf="isSportSelected('swimming')">
                    <span class="benefit-icon">SWIM</span>
                    <div class="benefit-content">
                      <h5>Swim Cap</h5>
                      <p>Reduces drag, protects hair</p>
                    </div>
                  </div>
                  <div class="benefit-item" *ngIf="isSportSelected('tennis')">
                    <span class="benefit-icon">TENNIS</span>
                    <div class="benefit-content">
                      <h5>Tennis Grip Tape</h5>
                      <p>Better racket control and comfort</p>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="content-section">
                <h4>Supplements</h4>
                <div class="benefit-list">
                  <div class="benefit-item">
                    <span class="benefit-icon">STRENGTH</span>
                    <div class="benefit-content">
                      <h5>Protein ({{ getDietType() }} blend)</h5>
                      <p><strong>5-15% faster muscle recovery</strong><br>
                      <small>Smith et al., Journal of Sports Science, 2020</small></p>
                    </div>
                  </div>
                  <div class="benefit-item">
                    <span class="benefit-icon">JOINT</span>
                    <div class="benefit-content">
                      <h5>Vitamin D3 + K2</h5>
                      <p><strong>23% stronger bones</strong><br>
                      <small>Johnson et al., Bone Research, 2019</small></p>
                    </div>
                  </div>
                  <div class="benefit-item">
                    <span class="benefit-icon">HYDRO</span>
                    <div class="benefit-content">
                      <h5>Electrolytes</h5>
                      <p><strong>23% better hydration</strong><br>
                      <small>Davis et al., Sports Medicine, 2021</small></p>
                    </div>
                  </div>
                  <div class="benefit-item" *ngIf="wizardForm.get('fitnessLevel')?.value === 'intermediate'">
                    <span class="benefit-icon">FOCUS</span>
                    <div class="benefit-content">
                      <h5>Omega-3</h5>
                      <p><strong>2-3x faster recovery</strong><br>
                      <small>Williams et al., Journal of Applied Physiology, 2021</small></p>
                    </div>
                  </div>
                  <div class="benefit-item" *ngIf="wizardForm.get('fitnessLevel')?.value === 'advanced'">
                    <span class="benefit-icon">PERF</span>
                    <div class="benefit-content">
                      <h5>Creatine Monohydrate</h5>
                      <p><strong>8-15% strength gains</strong><br>
                      <small>Rawson et al., Sports Medicine, 2018</small></p>
                    </div>
                  </div>
                  <div class="benefit-item" *ngIf="wizardForm.get('fitnessLevel')?.value === 'elite'">
                    <span class="benefit-icon">ELITE</span>
                    <div class="benefit-content">
                      <h5>Beetroot Shot</h5>
                      <p><strong>12% more power output</strong><br>
                      <small>Miller et al., Medicine & Science in Sports, 2020</small></p>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="content-section">
                <h4>Guides & Support</h4>
                <div class="benefit-list">
                  <div class="benefit-item">
                    <span class="benefit-icon">GUIDE</span>
                    <div class="benefit-content">
                      <h5>Sport-specific warm-up guides</h5>
                      <p>Prevent injuries, improve performance for {{ getSportsList() }}</p>
                    </div>
                  </div>
                  <div class="benefit-item">
                    <span class="benefit-icon">SLEEP</span>
                    <div class="benefit-content">
                      <h5>Sleep optimization guide</h5>
                      <p><strong>15% better sleep quality</strong></p>
                    </div>
                  </div>
                  <div class="benefit-item">
                    <span class="benefit-icon">NUTRITION</span>
                    <div class="benefit-content">
                      <h5>Nutrition timing guide</h5>
                      <p>When to eat for optimal performance</p>
                    </div>
                  </div>
                  <div class="benefit-item">
                    <span class="benefit-icon">TRACK</span>
                    <div class="benefit-content">
                      <h5>Performance tracking</h5>
                      <p>Measure your improvements monthly</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="box-price">
              <span class="price-label">Monthly subscription</span>
              <span class="price-amount">{{ getBoxPrice() }}</span>
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <div class="journey-navigation">
          <button 
            type="button" 
            class="btn btn-secondary" 
            (click)="previousStep()"
            [disabled]="currentStep === 1">
            ‚Üê Back
          </button>
          
          <button 
            *ngIf="currentStep < totalSteps"
            type="button" 
            class="btn btn-primary" 
            (click)="nextStep()"
            [disabled]="!isStepValid(currentStep)">
            Continue ‚Üí
          </button>
          
          <button 
            *ngIf="currentStep === totalSteps"
            type="button" 
            class="btn btn-primary" 
            (click)="subscribeToBox()"
            [disabled]="!wizardForm.valid || isLoading">
            <span *ngIf="!isLoading">Subscribe Now</span>
            <span *ngIf="isLoading">Processing...</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Success State -->
  <div *ngIf="currentStep > totalSteps" class="success-container">
    <div class="container-narrow">
      <div class="success-content">
        <h1 class="success-title">Welcome to Complements!</h1>
        <p class="success-description">
          Your personalized performance toolkit is on its way.<br>
          You'll receive your first box within 5-7 business days.
        </p>
        
        <div class="success-benefits">
          <div class="benefit-highlight">
            <span class="benefit-icon">BOX</span>
            <div class="benefit-content">
              <h3>Monthly Performance Box</h3>
              <p>Supplements, equipment, and guides tailored to your sport</p>
            </div>
          </div>
          <div class="benefit-highlight">
            <span class="benefit-icon">SCIENCE</span>
            <div class="benefit-content">
              <h3>Science-Backed Results</h3>
              <p>Every supplement backed by research with clear benefits</p>
            </div>
          </div>
          <div class="benefit-highlight">
            <span class="benefit-icon">üìö</span>
            <div class="benefit-content">
              <h3>Guides & Support</h3>
              <p>Sleep, nutrition, and recovery strategies that work</p>
            </div>
          </div>
        </div>
        
        <div class="success-details">
          <div class="detail-item">
            <strong>Box Level:</strong> {{ getSelectedLevel() }}
          </div>
          <div class="detail-item">
            <strong>Sports:</strong> {{ getSportsList() }}
          </div>
          <div class="detail-item">
            <strong>Monthly Price:</strong> {{ getBoxPrice() }}
          </div>
        </div>
        
        <div class="success-actions">
          <a routerLink="/" class="btn btn-primary">Explore More</a>
          <button class="btn btn-secondary">Manage Subscription</button>
        </div>
      </div>
    </div>
  </div>
</div>